<template>
  <div class="header">
    <svg class="header__logo" width="138" height="48" viewBox="0 0 138 48" xmlns="http://www.w3.org/2000/svg">
      <path d="M63.68 17L57.58 31H55.02L48.9 17H51.72L56.38 27.8L61.08 17H63.68Z"/>
      <path d="M74.9058 20.32V31H72.5258V29.64C72.1258 30.12 71.6258 30.4933 71.0258 30.76C70.4258 31.0133 69.7791 31.14 69.0858 31.14C67.6591 31.14 66.5324 30.7467 65.7058 29.96C64.8924 29.16 64.4858 27.98 64.4858 26.42V20.32H66.9858V26.08C66.9858 27.04 67.1991 27.76 67.6258 28.24C68.0658 28.7067 68.6858 28.94 69.4858 28.94C70.3791 28.94 71.0858 28.6667 71.6058 28.12C72.1391 27.56 72.4058 26.76 72.4058 25.72V20.32H74.9058Z"/>
      <path d="M88.2191 25.72C88.2191 25.8933 88.2057 26.14 88.1791 26.46H79.7991C79.9457 27.2467 80.3257 27.8733 80.9391 28.34C81.5657 28.7933 82.3391 29.02 83.2591 29.02C84.4324 29.02 85.3991 28.6333 86.1591 27.86L87.4991 29.4C87.0191 29.9733 86.4124 30.4067 85.6791 30.7C84.9457 30.9933 84.1191 31.14 83.1991 31.14C82.0257 31.14 80.9924 30.9067 80.0991 30.44C79.2057 29.9733 78.5124 29.3267 78.0191 28.5C77.5391 27.66 77.2991 26.7133 77.2991 25.66C77.2991 24.62 77.5324 23.6867 77.9991 22.86C78.4791 22.02 79.1391 21.3667 79.9791 20.9C80.8191 20.4333 81.7657 20.2 82.8191 20.2C83.8591 20.2 84.7857 20.4333 85.5991 20.9C86.4257 21.3533 87.0657 22 87.5191 22.84C87.9857 23.6667 88.2191 24.6267 88.2191 25.72ZM82.8191 22.2C82.0191 22.2 81.3391 22.44 80.7791 22.92C80.2324 23.3867 79.8991 24.0133 79.7791 24.8H85.8391C85.7324 24.0267 85.4057 23.4 84.8591 22.92C84.3124 22.44 83.6324 22.2 82.8191 22.2Z"/>
      <path d="M97.3405 31.2C95.9271 31.2 94.6471 30.8933 93.5005 30.28C92.3671 29.6533 91.4738 28.7933 90.8205 27.7C90.1805 26.6067 89.8605 25.3733 89.8605 24C89.8605 22.6267 90.1871 21.3933 90.8405 20.3C91.4938 19.2067 92.3871 18.3533 93.5205 17.74C94.6671 17.1133 95.9471 16.8 97.3605 16.8C98.5071 16.8 99.5538 17 100.5 17.4C101.447 17.8 102.247 18.38 102.9 19.14L101.22 20.72C100.207 19.6267 98.9605 19.08 97.4805 19.08C96.5205 19.08 95.6605 19.2933 94.9005 19.72C94.1405 20.1333 93.5471 20.7133 93.1205 21.46C92.6938 22.2067 92.4805 23.0533 92.4805 24C92.4805 24.9467 92.6938 25.7933 93.1205 26.54C93.5471 27.2867 94.1405 27.8733 94.9005 28.3C95.6605 28.7133 96.5205 28.92 97.4805 28.92C98.9605 28.92 100.207 28.3667 101.22 27.26L102.9 28.86C102.247 29.62 101.44 30.2 100.48 30.6C99.5338 31 98.4871 31.2 97.3405 31.2Z"/>
      <path d="M111.212 20.2C112.558 20.2 113.638 20.5933 114.452 21.38C115.265 22.1667 115.672 23.3333 115.672 24.88V31H113.172V25.2C113.172 24.2667 112.952 23.5667 112.512 23.1C112.072 22.62 111.445 22.38 110.632 22.38C109.712 22.38 108.985 22.66 108.452 23.22C107.918 23.7667 107.652 24.56 107.652 25.6V31H105.152V16.16H107.652V21.56C108.065 21.12 108.572 20.7867 109.172 20.56C109.785 20.32 110.465 20.2 111.212 20.2Z"/>
      <path d="M122.923 20.2C124.496 20.2 125.696 20.58 126.523 21.34C127.363 22.0867 127.783 23.22 127.783 24.74V31H125.423V29.7C125.116 30.1667 124.676 30.5267 124.103 30.78C123.543 31.02 122.863 31.14 122.063 31.14C121.263 31.14 120.563 31.0067 119.963 30.74C119.363 30.46 118.896 30.08 118.563 29.6C118.243 29.1067 118.083 28.5533 118.083 27.94C118.083 26.98 118.436 26.2133 119.143 25.64C119.863 25.0533 120.99 24.76 122.523 24.76H125.283V24.6C125.283 23.8533 125.056 23.28 124.603 22.88C124.163 22.48 123.503 22.28 122.623 22.28C122.023 22.28 121.43 22.3733 120.843 22.56C120.27 22.7467 119.783 23.0067 119.383 23.34L118.403 21.52C118.963 21.0933 119.636 20.7667 120.423 20.54C121.21 20.3133 122.043 20.2 122.923 20.2ZM122.583 29.32C123.21 29.32 123.763 29.18 124.243 28.9C124.736 28.6067 125.083 28.1933 125.283 27.66V26.42H122.703C121.263 26.42 120.543 26.8933 120.543 27.84C120.543 28.2933 120.723 28.6533 121.083 28.92C121.443 29.1867 121.943 29.32 122.583 29.32Z"/>
      <path d="M137.412 30.42C137.118 30.66 136.758 30.84 136.332 30.96C135.918 31.08 135.478 31.14 135.012 31.14C133.838 31.14 132.932 30.8333 132.292 30.22C131.652 29.6067 131.332 28.7133 131.332 27.54V22.4H129.572V20.4H131.332V17.96H133.832V20.4H136.692V22.4H133.832V27.48C133.832 28 133.958 28.4 134.212 28.68C134.465 28.9467 134.832 29.08 135.312 29.08C135.872 29.08 136.338 28.9333 136.712 28.64L137.412 30.42Z"/>
      <path d="M42.77 37.3308C45.7504 34.6745 47.438 31.134 47.438 27.4599C47.438 23.5552 45.6101 19.9034 42.2908 17.1767C39.0604 14.5237 34.7844 13.0625 30.25 13.0625C25.7156 13.0625 21.4396 14.5237 18.2097 17.1769C14.8904 19.9034 13.0625 23.5552 13.0625 27.4599C13.0625 31.3645 14.8904 35.0163 18.2097 37.7431C21.4396 40.3962 25.7156 41.8573 30.25 41.8573C30.8542 41.8573 31.4621 41.8307 32.0649 41.7776L33.0948 42.6703C36.6428 45.7448 41.1802 47.4373 45.875 47.4375H47.4375V44.1116L46.9799 43.6541C45.1746 41.8435 43.7441 39.6948 42.77 37.3308ZM35.1415 40.3086L33.075 38.5175L32.3859 38.602C31.6773 38.6886 30.964 38.7321 30.25 38.7321C22.4961 38.7321 16.1875 33.6754 16.1875 27.4599C16.1875 21.2443 22.4961 16.1875 30.25 16.1875C38.0039 16.1875 44.3125 21.2442 44.3125 27.4599C44.3125 30.5565 42.7676 33.4476 39.9623 35.6003L39.0624 36.2908L39.4776 37.4661C40.3286 39.8665 41.5794 42.1056 43.177 44.0889C40.2017 43.5922 37.4211 42.2841 35.1415 40.3086Z"/>
      <path d="M4.87744 30.0035C6.34006 28.1521 7.48844 26.0728 8.27666 23.8489L8.68877 22.6795L7.78965 21.9895C5.14434 19.9596 3.6875 17.2352 3.6875 14.3181C3.6875 8.45635 9.64541 3.6875 16.9688 3.6875C22.3562 3.6875 27.0046 6.26855 29.0856 9.9668C29.4721 9.94805 29.8602 9.9375 30.25 9.9375C31.033 9.9375 31.8089 9.97549 32.5775 10.0515C31.7733 7.96797 30.3767 6.06602 28.4564 4.48887C25.3742 1.95693 21.2949 0.5625 16.9688 0.5625C12.6426 0.5625 8.56328 1.95693 5.48086 4.48887C2.30918 7.09424 0.5625 10.585 0.5625 14.3181C0.5625 17.8142 2.15937 21.1828 4.98145 23.7168C4.06049 25.9331 2.7148 27.9478 1.02021 29.6474L0.5625 30.105V33.375H2.125C5.01436 33.3746 7.86399 32.7018 10.4483 31.4097C10.165 30.3356 9.99891 29.2339 9.95312 28.124C8.38455 29.0433 6.66647 29.6795 4.87744 30.0035Z"/>
    </svg>

    <div class="header__item" @click="changeTheme">
      <svg v-if="theme === 'light'" class="header__theme-icon" width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
        <path class="btn-core" :d="this.path1" />
        <path opacity="1" class="btn-rays" fill-rule="evenodd" clip-rule="evenodd" d="M39.805 26.4509C39.9142 26.3616 39.9688 26.2723 39.9688 26.183C40.0312 25.9598 40 25.744 39.8752 25.5357L35.6391 20L39.8752 14.4643C40 14.256 40.0312 14.0402 39.9688 13.817C39.9688 13.7277 39.9142 13.6384 39.805 13.5491C39.6957 13.4598 39.5943 13.4003 39.5007 13.3705L32.6434 11.2054V4.375C32.6434 4.1369 32.542 3.94345 32.3391 3.79464C32.1207 3.66071 31.8945 3.63095 31.6604 3.70536L24.8265 5.80357L20.6138 0.267857C20.4734 0.0892857 20.2705 0 20.0053 0C19.7401 0 19.5372 0.0892857 19.3968 0.267857L15.1841 5.80357L8.35017 3.70536C8.11613 3.63095 7.88989 3.66071 7.67145 3.79464C7.48422 3.91369 7.375 4.10714 7.3438 4.375V11.2054L0.50987 13.3705C0.260229 13.4449 0.104203 13.5938 0.0417926 13.817C-0.0362203 14.0551 -0.00501512 14.2708 0.135408 14.4643L4.3481 20L0.135408 25.5357C-0.00501512 25.7292 -0.0362203 25.9449 0.0417926 26.183C0.104203 26.4063 0.260229 26.5551 0.50987 26.6295L7.3438 28.7946V35.625C7.375 35.8929 7.48422 36.0863 7.67145 36.2054C7.88989 36.3393 8.11613 36.369 8.35017 36.2946L15.1841 34.1964L19.3968 39.7321C19.5372 39.9107 19.7401 40 20.0053 40C20.2705 40 20.4734 39.9107 20.6138 39.7321L24.8265 34.1964L31.6604 36.2946C31.8945 36.369 32.1207 36.3393 32.3391 36.2054C32.542 36.0565 32.6434 35.8631 32.6434 35.625V28.7946L39.5007 26.6295C39.5943 26.5997 39.6957 26.5402 39.805 26.4509ZM20 32.8C27.0692 32.8 32.8 27.0692 32.8 20C32.8 12.9308 27.0692 7.2 20 7.2C12.9308 7.2 7.2 12.9308 7.2 20C7.2 27.0692 12.9308 32.8 20 32.8Z"/>
      </svg>

      <svg v-else class="header__theme-icon" width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
        <path class="btn-core" :d="this.path2" />
        <path opacity="0" class="btn-rays" fill-rule="evenodd" clip-rule="evenodd" d="M39.805 26.4509C39.9142 26.3616 39.9688 26.2723 39.9688 26.183C40.0312 25.9598 40 25.744 39.8752 25.5357L35.6391 20L39.8752 14.4643C40 14.256 40.0312 14.0402 39.9688 13.817C39.9688 13.7277 39.9142 13.6384 39.805 13.5491C39.6957 13.4598 39.5943 13.4003 39.5007 13.3705L32.6434 11.2054V4.375C32.6434 4.1369 32.542 3.94345 32.3391 3.79464C32.1207 3.66071 31.8945 3.63095 31.6604 3.70536L24.8265 5.80357L20.6138 0.267857C20.4734 0.0892857 20.2705 0 20.0053 0C19.7401 0 19.5372 0.0892857 19.3968 0.267857L15.1841 5.80357L8.35017 3.70536C8.11613 3.63095 7.88989 3.66071 7.67145 3.79464C7.48422 3.91369 7.375 4.10714 7.3438 4.375V11.2054L0.50987 13.3705C0.260229 13.4449 0.104203 13.5938 0.0417926 13.817C-0.0362203 14.0551 -0.00501512 14.2708 0.135408 14.4643L4.3481 20L0.135408 25.5357C-0.00501512 25.7292 -0.0362203 25.9449 0.0417926 26.183C0.104203 26.4063 0.260229 26.5551 0.50987 26.6295L7.3438 28.7946V35.625C7.375 35.8929 7.48422 36.0863 7.67145 36.2054C7.88989 36.3393 8.11613 36.369 8.35017 36.2946L15.1841 34.1964L19.3968 39.7321C19.5372 39.9107 19.7401 40 20.0053 40C20.2705 40 20.4734 39.9107 20.6138 39.7321L24.8265 34.1964L31.6604 36.2946C31.8945 36.369 32.1207 36.3393 32.3391 36.2054C32.542 36.0565 32.6434 35.8631 32.6434 35.625V28.7946L39.5007 26.6295C39.5943 26.5997 39.6957 26.5402 39.805 26.4509ZM20 32.8C27.0692 32.8 32.8 27.0692 32.8 20C32.8 12.9308 27.0692 7.2 20 7.2C12.9308 7.2 7.2 12.9308 7.2 20C7.2 27.0692 12.9308 32.8 20 32.8Z"/>
      </svg>
    </div>

  </div>
</template>

<script>
import anime from 'animejs';
import { mapGetters, mapActions } from 'vuex';
export default {
  name: 'Header',
  data() {
    return {
      theme: '',
      path1: 'M31.2 20C31.2 23.5326 29.5645 26.6832 27.0094 28.736C25.0905 30.2776 22.653 31.2 20 31.2C13.8144 31.2 8.8 26.1856 8.8 20C8.8 13.8144 13.8144 8.79997 20 8.79997C22.653 8.79997 25.0905 9.72238 27.0094 11.264C29.5645 13.3167 31.2 16.4674 31.2 20Z',
      path2: 'M32 4.38454C24.9576 5.98171 19.6938 12.3666 19.6938 20C19.6938 27.6334 24.9576 34.0183 32 35.6155C28.6288 38.359 24.35 40 19.6938 40C8.81724 40 0 31.0457 0 20C0 8.9543 8.81724 0 19.6938 0C24.35 0 28.6288 1.64099 32 4.38454Z',
    }
  },
  computed: {
    ...mapGetters(['getTheme'])
  },
  mounted() {
    this.theme = this.getTheme
    window.addEventListener('storage', e => {
      if (e.key === 'theme') {
        this.animation('other');
      }
    });
  },
  destroyed() {
    window.removeEventListener('storage', e => {
      if (e.key === 'theme') {
        this.animation('other');
      }
    });
  },
  methods: {
    ...mapActions(['setTheme']),
    animation(mode) {
      let path;
      let opacity;

      if (mode) {
        path = this.getTheme !== 'light' ? this.path1 : this.path2;
        opacity = this.getTheme !== 'light' ? 1 : 0;
      } else {
        path = this.getTheme === 'light' ? this.path1 : this.path2;
        opacity = this.getTheme === 'light' ? 1 : 0;
      }

      anime({
        targets: '.btn-core',
        d: [
          {
            value: [
              path
            ]
          },
        ],
        easing: 'easeOutQuad',
        duration: 500,
        autoplay: true
      });
      anime({
        targets: '.btn-rays',
        opacity,
        easing: 'easeOutQuad',
        duration: 500,
        autoplay: true
      });
    },
    changeTheme() {
      this.setTheme();
      this.animation();
    }
  }
}
</script>

<style lang="scss">
  .header {
    grid-area: header;
    background: var(--primary);
    height: 54px;
    display: flex;
    align-items: center;
    transition: background .5s;
    border-bottom: 1px solid var(--border-color);

    > .header__logo {
      margin-left: 5px;
    }

    > .header__item {
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
      margin-left: auto;
      height: 100%;
      padding: 0 5px;
      display: flex;
      align-items: center;
    }
  }
</style>